var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var d=b.length;for(c=c||0;c<d;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");function UIRedrawTimer(){this.time=null}UIRedrawTimer.prototype.timer=function(a,b){b||(b=20);this.time||this.timerLauncher(b,a);this.time=(new Date).getTime();this.time+=b};
UIRedrawTimer.prototype.timerLauncher=function(a,b){setTimeout(function(){var a=(new Date).getTime();a>this.time?(b(),this.time=null):this.timerLauncher(this.time-a,b)}.bind(this),a)};function UIViewUtils(){}UIViewUtils.prototype.calculateWidthView=function(a,b,c,e){b.style.position="fixed";a=b.offsetWidth;0<a&&a++;return a};UIViewUtils.prototype.calculateHeightView=function(a,b,c,e){b.style.position="fixed";a=b.offsetHeight;0<a&&a++;return a};
UIViewUtils.prototype.calculateWidthViewSlow=function(a,b){a=b.parentElement;var c=a.offsetWidth,e=a.scrollLeft;a.style.width=1E4;b.style.display="inline-block";b.style.width="auto";b.style.height="auto";b=b.offsetWidth;0<b&&b++;a.style.width=c;a.scrollLeft=e;return b};
UIViewUtils.prototype.calculateHeightViewSlow=function(a,b){a=b.parentElement;var c=a.offsetHeight,e=a.scrollTop;a.style.height=1E4;b.style.display="inline-block";b.style.width="auto";b.style.height="auto";b=b.offsetHeight;0<b&&b++;a.style.height=c;a.scrollTop=e;return b};UIViewUtils.prototype.generateIndexes=function(a){for(var b=[],c=0;c<a.length;c++)a[c].id&&(b[a[c].id]=c);return b};
UIViewUtils.prototype.generateArrayViews=function(a,b){null==b&&(b=[]);b.push(a);a.forEachChild(function(a,e){this.generateArrayViews(a,b)}.bind(this));return b};UIViewUtils.prototype.getViewsWithDependencyForView=function(a,b,c){var e=[];if(!a.parent)return e;var d=a.id;a.parent.forEachChild(function(a,h){(b&&a.dependenciesHor.includes(d)||c&&a.dependenciesVer.includes(d))&&e.push(a)});return e};function UIUtils(){}UIUtils.prototype.readAttributes=function(a){if(null==a)return[];a=a.replace(" ","").split(";");for(var b=[],c=0;c<a.length;c++){var e=a[c].split(":");2==e.length?b.push({attr:e[0],value:e[1]}):1==e.length&&b.push({attr:e[0],value:""})}return b};var uiShowLogs=!1,uiViewLogs=null;function log(a){logShow(0,a)}function logW(a){logShow(1,a)}function logE(a){logShow(2,a)}function logI(a){logShow(3,a)}function logIView(a,b){logI("["+a+"] "+b.toString());b.forEachChild(function(b,e){logIView(a,b)})}function logShow(a,b){if(uiShowLogs){switch(a){case 1:b="WARNING: "+b;break;case 2:b="ERROR: "+b;break;case 3:b="INFO: "+b}console.log(b);uiViewLogs&&(uiViewLogs.innerHTML+=b+"<BR />")}};function getScrollWidth(){var a=document.createElement("p");a.style.width="100%";a.style.height="200px";var b=document.createElement("div");b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.visibility="hidden";b.style.width="200px";b.style.height="150px";b.style.overflow="hidden";b.appendChild(a);document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";a=a.offsetWidth;c==a&&(a=b.clientWidth);document.body.removeChild(b);return c-a}
function cleanViews(a){a.clean();a.forEachChild(function(a,c){cleanViews(a)})}var counters={};function startCounter(a){var b=(new Date).getTime();counters[a]=b}function endCounter(a){return(new Date).getTime()-counters[a]}function endCounterLog(a){log("Counter["+a+"]: "+endCounter(a)+"ms")};function UIConfiguration(a){this.attribute="ui";this.attributes=[];this.dimens={};this.timeRedraw=20;this.showLogs=this.viewColors=!1;this.logsView=null;if(a){a.viewColors&&(this.viewColors=!0);a.showLogs&&(this.showLogs=!0,a.viewLogs&&(this.logsView=document.getElementById(a.viewLogs)));null!=a.events&&(this.events=a.events);null==a.timeRedraw||isNaN(a.timeRedraw)||(this.timeRedraw=parseInt(a.timeRedraw,10));a.attribute&&(this.attribute=a.attribute);this.dimens={};if(a.dimens)for(var b=Object.keys(a.dimens),
c=0;c<b.length;c++)this.dimens[b[c]]=a.dimens[b[c]];this.screenModes=a.screenModes;this.refreshScreenSize()}}
UIConfiguration.prototype.refreshScreenSize=function(){var a=[],b=this.dimens,c=window.innerWidth,e=window.innerHeight;log("screen-width: "+c);log("screen-height: "+e);if(this.screenModes)for(var d=0;d<this.screenModes.length;d++){var f=this.screenModes[d];if((!f.widthStart||0==f.widthStart||f.widthStart<c)&&(!f.widthEnd||0==f.widthEnd||f.widthEnd>c)&&(!f.heightStart||0==f.heightStart||f.heightStart<e)&&(!f.heightEnd||0==f.heightEnd||f.heightEnd<e)&&(a.push(f.attribute),log("SHOWING ATTRIBUTE: "+
f.attribute),f.dimens))for(var h=Object.keys(f.dimens),k=0;k<h.length;k++)b[h[k]]=f.dimens[h[k]]}this.attributes=a;this.selectedDimens=b};UIConfiguration.prototype.getDimen=function(a){if(this.selectedDimens[a])return parseInt(this.selectedDimens[a],10);if(a&&!isNaN(parseInt(a,10)))return parseInt(a,10);logE('The dimension "'+a+'" is not valid or it is not defined');return 0};UIConfiguration.prototype.sendStartEvent=function(){this.events&&this.events({name:"start"})};
UIConfiguration.prototype.sendEndEvent=function(){this.events&&this.events({name:"end",attributes:this.attributes})};function UIView(a,b,c,e,d,f){this.id=a.id;this.element=a;this.parent=b;this.screen=c;this.childrenOrderHor=[];this.childrenOrderVer=[];this.childrenUI=!0;this.orderNum=this.order=0;this.dependenciesHor=[];this.dependenciesVer=[];this.bottomTop=this.bottomBottom=this.topBottom=this.topTop=this.rightLeft=this.rightRight=this.leftRight=this.leftLeft="";this.sizeHeight=this.sizeWidth="sc";this.bottom=this.right=this.top=this.left=0;this.bottomChanged=this.rightChanged=this.topChanged=this.leftChanged=
!1;this.height=this.width=0;this.scrollHorizontalApplied=this.scrollVerticalApplied=this.scrollHorizontal=this.scrollVertical=!1;this.percentTop=this.percentLeft=this.percentHeight=this.percentWidth=0;this.gravityVer=this.gravityHor="n";this.marginBottomDimen=this.marginRightDimen=this.marginTopDimen=this.marginLeftDimen="0";this.marginBottom=this.marginRight=this.marginTop=this.marginLeft=0;this.paddingBottomDimen=this.paddingRightDimen=this.paddingTopDimen=this.paddingLeftDimen="0";this.paddingBottom=
this.paddingRight=this.paddingTop=this.paddingLeft=0;this.visibility="v";this.childrenInOrder=this.sizeLoaded=!1;this.animationDurations=[];this.updateVisibilityWithCss();this.readUI(a,b,e?e:"",d,f);a.ui=this;a.ui=this;this.setWidth=this.setWidth;this.setHeight=this.setHeight;this.setLeft=this.setLeft;this.setRight=this.setRight;this.setTop=this.setTop;this.setBottom=this.setBottom;this.setAtLeft=this.setAtLeft;this.setAtRight=this.setAtRight;this.setAtTop=this.setAtTop;this.setAtBottom=this.setAtBottom;
this.setMarginLeft=this.setMarginLeft;this.setMarginRight=this.setMarginRight;this.setMarginTop=this.setMarginTop;this.setMarginBottom=this.setMarginBottom;this.setMargins=this.setMargins;this.setPaddingLeft=this.setPaddingLeft;this.setPaddingRight=this.setPaddingRight;this.setPaddingTop=this.setPaddingTop;this.setPaddingBottom=this.setPaddingBottom;this.setPaddings=this.setPaddings;this.setVisibility=this.setVisibility;this.animateNextRefresh=this.animateNextRefresh}
UIView.prototype.setWidth=function(a){if("sc"==a)this.sizeWidth=a,this.width=0;else if(-1!=String(a).indexOf("%")){var b=a.indexOf("%");this.percentWidth=parseFloat(a.substring(0,b));b<a.length-1&&(this.percentLeft=parseInt(a.substring(b+1,a.length),10));this.sizeWidth="sp"}else this.width=parseInt(a,10),this.sizeWidth="s";this.sizeLoaded=!1};
UIView.prototype.setHeight=function(a){if("sc"==a)this.sizeHeight=a,this.height=0;else if(-1!=String(a).indexOf("%")){var b=a.indexOf("%");this.percentHeight=parseInt(a.substring(0,b),10);b<a.length-1&&(this.percentTop=parseInt(a.substring(b+1,a.length),10));this.sizeHeight="sp"}else this.height=parseInt(a,10),this.sizeHeight="s";this.sizeLoaded=!1};UIView.prototype.setLeft=function(a){this.leftLeft=a;this.sizeLoaded=!1};UIView.prototype.setRight=function(a){this.rightRight=a;this.sizeLoaded=!1};
UIView.prototype.setTop=function(a){this.topTop=a;this.sizeLoaded=!1};UIView.prototype.setBottom=function(a){this.bottomBottom=a;this.sizeLoaded=!1};UIView.prototype.setAtLeft=function(a){this.rightLeft=a;this.sizeLoaded=!1};UIView.prototype.setAtRight=function(a){this.leftRight=a;this.sizeLoaded=!1};UIView.prototype.setAtTop=function(a){this.bottomTop=a;this.sizeLoaded=!1};UIView.prototype.setAtBottom=function(a){this.topBottom=a;this.sizeLoaded=!1};
UIView.prototype.setScrollVertical=function(a){this.scrollVertical=a};UIView.prototype.setScrollHorizontal=function(a){this.scrollHorizontal=a};UIView.prototype.setGravityHorizontal=function(a){this.gravityHor=a};UIView.prototype.setGravityVertical=function(a){this.gravityVer=a};UIView.prototype.setGravity=function(a,b){this.gravityHor=a;this.gravityVer=b};UIView.prototype.setMarginLeft=function(a){this.marginLeftDimen=a;this.sizeLoaded=!1};
UIView.prototype.setMarginTop=function(a){this.marginTopDimen=a;this.sizeLoaded=!1};UIView.prototype.setMarginRight=function(a){this.marginRightDimen=a;this.sizeLoaded=!1};UIView.prototype.setMarginBottom=function(a){this.marginBottomDimen=a;this.sizeLoaded=!1};UIView.prototype.setMargins=function(a,b,c,e){this.marginLeftDimen=a;this.marginTopDimen=b;this.marginRightDimen=c;this.marginBottomDimen=e;this.sizeLoaded=!1};
UIView.prototype.setPaddingLeft=function(a){this.paddingLeftDimen=a;this.sizeLoaded=!1};UIView.prototype.setPaddingTop=function(a){this.paddingTopDimen=a;this.sizeLoaded=!1};UIView.prototype.setPaddingRight=function(a){this.paddingRightDimen=a;this.sizeLoaded=!1};UIView.prototype.setPaddingBottom=function(a){this.paddingBottomDimen=a;this.sizeLoaded=!1};
UIView.prototype.setPaddings=function(a,b,c,e){this.paddingLeftDimen=a;this.paddingTopDimen=b;this.paddingRightDimen=c;this.paddingBottomDimen=e;this.sizeLoaded=!1};UIView.prototype.setVisibility=function(a){"g"!=a&&"g"==this.visibility&&(this.sizeLoaded=!1);this.visibility=a};UIView.prototype.updateVisibilityWithCss=function(){"none"==this.element.style.display?this.setVisibility("g"):"hidden"==this.element.style.visibility?this.setVisibility("i"):this.setVisibility("v")};
UIView.prototype.hasToBeCalculated=function(){return"g"!=this.visibility};UIView.prototype.animateNextRefresh=function(a){this.animationDurations.push(a)};UIView.prototype.getReferences=function(){return[this.leftLeft,this.leftRight,this.rightRight,this.rightLeft,this.topTop,this.topBottom,this.bottomBottom,this.bottomTop]};UIView.prototype.getReferencesHor=function(){return[this.leftLeft,this.leftRight,this.rightRight,this.rightLeft]};
UIView.prototype.getReferencesVer=function(){return[this.topTop,this.topBottom,this.bottomBottom,this.bottomTop]};UIView.prototype.setReference=function(a,b){switch(a){case 0:this.leftLeft=b;break;case 1:this.leftRight=b;break;case 2:this.rightRight=b;break;case 3:this.rightLeft=b;break;case 4:this.topTop=b;break;case 5:this.topBottom=b;break;case 6:this.bottomBottom=b;break;case 7:this.bottomTop=b}};
UIView.prototype.hasUIChildren=function(){for(var a=this.element.childNodes,b=0;b<a.length;b++)if(a[b].ui)return!0;return!1};UIView.prototype.getChildElements=function(){return this.element.childNodes};UIView.prototype.forEachChild=function(a){for(var b=this.element.childNodes,c=0;c<b.length;c++){var e=b[c].ui;e&&a(e,c)}};
UIView.prototype.getPreviousView=function(){for(var a=null,b=this.parent.element.childNodes,c=0;c<b.length;c++){var e=b[c].ui;if(e){if(e.id==this.id)return a;e.hasToBeCalculated()&&(a=e)}}return null};UIView.prototype.clean=function(){this.bottomChanged=this.rightChanged=this.topChanged=this.leftChanged=!1;this.bottom=this.right=this.top=this.left=0;0<this.percentWidth&&(this.sizeWidth="sp");0<this.percentHeight&&(this.sizeHeight="sp")};
UIView.prototype.applyDimens=function(a){this.paddingLeft=a.getDimen(this.paddingLeftDimen);this.paddingRight=a.getDimen(this.paddingRightDimen);this.paddingTop=a.getDimen(this.paddingTopDimen);this.paddingBottom=a.getDimen(this.paddingBottomDimen);this.marginLeft=a.getDimen(this.marginLeftDimen);this.marginRight=a.getDimen(this.marginRightDimen);this.marginTop=a.getDimen(this.marginTopDimen);this.marginBottom=a.getDimen(this.marginBottomDimen)};
UIView.prototype.toString=function(){return"["+this.id+"]: ll:"+this.leftLeft+", lr:"+this.leftRight+", rr:"+this.rightRight+", rl:"+this.rightLeft+", tt:"+this.topTop+",tb: "+this.topBottom+", bb:"+this.bottomBottom+", bt:"+this.bottomTop+", ml:"+this.marginLeft+", mr:"+this.marginRight+", mt:"+this.marginTop+",mb: "+this.marginBottom+", pl:"+this.paddingLeft+", pr:"+this.paddingRight+", pt:"+this.paddingTop+", pb:"+this.paddingBottom+", w:"+this.width+", h:"+this.height+", sh:"+this.sizeWidth+", sh:"+
this.sizeHeight+", pId:"+(this.parent?this.parent.id:"")+", l:"+this.left+", r:"+this.right+", t:"+this.top+", b:"+this.bottom};
UIView.prototype.readUI=function(a,b,c,e,d){c=UIUtilsInstance.readAttributes(a.getAttribute(e));for(b=0;b<d.length;b++)c=c.concat(UIUtilsInstance.readAttributes(a.getAttribute(d[b])));if(0!=c.length){for(b=0;b<c.length;b++)d=c[b].attr,a=c[b].value,"w"==d?this.setWidth(a):"fw"==d?this.setWidth("100%"):"h"==d?this.setHeight(a):"fh"==d?this.setHeight("100%"):"l"==d?this.setLeft(a):"r"==d?this.setRight(a):"t"==d?this.setTop(a):"b"==d?this.setBottom(a):"al"==d?this.setAtLeft(a):"ale"==d?(this.setAtLeft(a),
this.setTop(a),this.setBottom(a)):"ar"==d?this.setAtRight(a):"are"==d?(this.setAtRight(a),this.setTop(a),this.setBottom(a)):"at"==d?this.setAtTop(a):"ate"==d?(this.setAtTop(a),this.setLeft(a),this.setRight(a)):"ab"==d?this.setAtBottom(a):"abe"==d?(this.setAtBottom(a),this.setLeft(a),this.setRight(a)):"ml"==d?this.setMarginLeft(a):"mr"==d?this.setMarginRight(a):"mt"==d?this.setMarginTop(a):"mb"==d?this.setMarginBottom(a):"m"==d?(d=a.split(","),1==d.length?this.setMargins(a,a,a,a):4==d.length&&this.setMargins(d[0],
d[1],d[2],d[3])):"pl"==d?this.setPaddingLeft(a):"pr"==d?this.setPaddingRight(a):"pt"==d?this.setPaddingTop(a):"pb"==d?this.setPaddingBottom(a):"p"==d?(d=a.split(","),1==d.length?this.setPaddings(a,a,a,a):4==d.length&&this.setPaddings(d[0],d[1],d[2],d[3])):"gh"==d?this.setGravityHorizontal(a):"gv"==d?this.setGravityVertical(a):"g"==d?(a=a.split(","),2==a.length&&this.setGravity(a[0],a[1])):"cui"==d?this.childrenUI="n"==a?!1:!0:"sv"==d?this.setScrollVertical(!0):"sh"==d?this.setScrollHorizontal(!0):
"v"==d&&this.setVisibility(a);c=!1;a=this.getReferencesHor();for(b=0;b<a.length;b++)if(0<a[b].length){c=!0;break}c||this.setLeft("p");c=!1;a=this.getReferencesVer();for(b=0;b<a.length;b++)if(0<a[b].length){c=!0;break}c||this.setTop("p")}};function UIPrepare(a){this.refreshFunc=a;this.generatedId=0;this.imgEventsAdded=!1}UIPrepare.prototype.orderViews=function(a){a.childrenInOrder||(a.forEachChild(function(a,c){a.dependenciesHor=[];a.dependenciesVer=[]}),a.childrenOrderHor=this.orderViewsSameParent(a,!0),a.childrenOrderVer=this.orderViewsSameParent(a,!1),a.childrenInOrder=!0);a.forEachChild(function(a,c){0<a.getChildElements().length&&this.orderViews(a)}.bind(this))};
UIPrepare.prototype.orderViewsSameParent=function(a,b){var c=a.getChildElements(),e=[],d=0,f=null;a.forEachChild(function(c,g){g=0;for(var h=b?c.getReferencesHor():c.getReferencesVer(),l=0;l<h.length;l++){var k=h[l];"p"==k?k=a.id:"l"==k&&(k=f?f.id:"");0<k.length&&(b?c.dependenciesHor.push(k):c.dependenciesVer.push(k),g++)}0==g?(c.orderNum=0,d++):c.orderNum=-1;e.push(c);f=c});var h=UIViewUtilsInstance.generateIndexes(c);do{var k=!0;var g=0;a.forEachChild(function(a,d){if(-1==a.orderNum){d=b?a.dependenciesHor:
a.dependenciesVer;for(var e=0,f=0;f<d.length;f++){var l=0;null!=h[d[f]]&&(l=c[h[d[f]]].ui.orderNum);if(-1<l)e+=l+1;else{e=0;break}}0<e?(a.orderNum=e,g++):k=!1}})}while(!k&&0<g);0==g&&a.hasUIChildren()&&d<c.length&&logE("Check cycle references in "+(b?"horizontal":"vertical")+" for parent "+a.id);e.sort(function(a,b){return a.orderNum-b.orderNum});return e};
UIPrepare.prototype.loadSizes=function(a,b,c){c=void 0===c?!1:c;for(var e=0;e<a.length;e++){var d=a[e],f=d.ui;f&&f.hasToBeCalculated()&&("none"==d.style.display&&(d.style.display="inline-block"),!f.hasToBeCalculated()||!c&&f.sizeLoaded||("sc"!=f.sizeWidth||f.hasUIChildren()||(f.width=UIViewUtilsInstance.calculateWidthView(f,d)),"sc"!=f.sizeHeight||f.hasUIChildren()||(f.height=UIViewUtilsInstance.calculateHeightView(f,d)),f.applyDimens(b),f.sizeLoaded=!0),this.loadSizes(f.getChildElements(),b,c||!f.sizeLoaded))}};
UIPrepare.prototype.loadSizeScreen=function(a){var b=!1,c=a.element;c.style.position="absolute";if("sc"!=a.sizeWidth){"s"==a.sizeWidth?c.style.width=a.width+"px":"sp"==a.sizeWidth&&(c.style.width=a.percentWidth+"%");var e=c.offsetWidth;e!=a.width&&(a.width=e,b=!0)}"sc"!=a.sizeHeight&&("s"==a.sizeHeight?c.style.height=a.height+"px":"sp"==a.sizeWidth&&(c.style.height=a.percentHeight+"%"),a.height=c.offsetHeight);c.style.position="relative";a.right=a.width;a.bottom=a.height;a.rightChanged=!0;a.leftChanged=
!0;a.bottomChanged=!0;a.topChanged=!0;a.sizeLoaded=!0;return b};UIPrepare.prototype.restoreSizes=function(a,b){for(var c=0;c<a.children.length&&c<b.length;c++)a.children[c].width=b[c].width,a.children[c].height=b[c].height,this.restoreSizes(a.children[c],b[c].children)};
UIPrepare.prototype.generateUIView=function(a,b,c,e,d){return a.ui?a.ui:null!=a.tagName&&null!=a.getAttribute(e.attribute)?(0==a.id.length&&(a.id="_aID_"+this.generatedId,this.generatedId++),b=new UIView(a,b,c,d,e.attribute,e.attributes),null!=a.tagName&&"img"==a.tagName.toLowerCase()&&(a.onload=function(){a.sizeLoaded=!1;this.refreshFunc()}.bind(this)),b):null};
UIPrepare.prototype.generateUIViews=function(a,b,c,e,d){c||(c=[]);var f=null,h=null;if(null==e){e=a.parentNode;var k=a.previousSibling;null!=k&&k.id&&(d=k.id)}null!=e&&e.ui&&(f=a.parentNode.ui,h=f.screen?f.screen:f);(e=this.generateUIView(a,f,h,b,d))&&!f&&(c.push(e),a.style.position="relative");f=e?e.id:"";for(d=0;d<a.childNodes.length;d++)if(h=this.generateUIViews(a.childNodes[d],b,c,a,f))f=h.id;return e};function UIDraw(){}
UIDraw.prototype.applyPositions=function(a,b){var c=0,e=0,d=0,f=0,h=0,k=0;a.forEachChild(function(g,m){var l=g.element;k=h=f=d=0;0==l.childElementCount&&(m=window.getComputedStyle(l),"sc"==g.sizeWidth&&(d=parseInt(m.paddingLeft,10),f=parseInt(m.paddingRight,10)),"sc"==g.sizeHeight&&(h=parseInt(m.paddingTop,10),k=parseInt(m.paddingBottom,10)));l.style.display="inline-block";l.style.margin="auto";0<l.childElementCount&&(l.style.padding="0px");if("g"==g.visibility||"g"==a.visibility)l.style.display="none";
l.style.visibility="i"==g.visibility||"i"==a.visibility?"hidden":"visible";m=parseInt(g.left,10);var r=parseInt(g.top,10),n=0<g.width?g.width-d-f:0,p=0<g.height?g.height-h-k:0;l.style.left=m+"px";l.style.top=r+"px";0<n&&(l.style.width=n+"px");0<p&&(l.style.height=p+"px");l.style.position="absolute";if(0<g.animationDurations.length){l.style.transition="all "+g.animationDurations[0]+"s ease 0s";l.ui.animationDurations.splice(0,1);var q=function(a){log(a);l.style.transition="";l.removeEventListener("transitionend",
q)};l.addEventListener("transitionend",q)}g.left+g.width>c&&(c=g.left+g.width);g.top+g.height>e&&(e=g.top+g.height);b&&(l.style.backgroundColor=this.generateRandomViewColor());g=this.applyPositions(g,b);g.maxX>c&&(c=g.maxX);g.maxY>e&&(e=g.maxY)}.bind(this));return{maxX:c,maxY:e}};UIDraw.prototype.generateRandomViewColor=function(){var a=parseInt(255*Math.random(),10),b=parseInt(255*Math.random(),10),c=parseInt(255*Math.random(),10);return"rgba("+a+","+b+","+c+",0.4)"};
UIDraw.prototype.applySizeScreen=function(a,b,c){var e=document.getElementById(a.id);"s"!=a.id&&null!=e&&(e.style.width="s"==a.sizeWidth?a.width+"px":"sp"==a.sizeWidth?a.percentWidth+"%":b+"px",e.style.height="s"==a.sizeHeight?a.height+"px":"sp"==a.sizeHeight?a.percentHeight+"%":c+"px")};function UICore(a){this.scrollWidth=a}UICore.prototype.calculateScreen=function(a){var b=UIViewUtilsInstance.generateArrayViews(a),c=UIViewUtilsInstance.generateIndexes(b);do{var e=[];for(var d=1;d<b.length;d++)b[d].clean();this.calculateViewsHor(a.childrenOrderHor,a,b,c,a.width,e);this.calculateViewsVer(a.childrenOrderVer,a,b,c,a.height,e)}while(0<e.length)};
UICore.prototype.calculateViewsHor=function(a,b,c,e,d,f){for(var h=0;h<a.length;h++)a[h].hasToBeCalculated()&&this.calculateViewHor(a[h],b,c,e,d,f)};
UICore.prototype.calculateViewHor=function(a,b,c,e,d,f){for(var h=a.getReferencesHor(),k=0;k<h.length;k++){var g=this.calculateViewDependency(a,h[k],b);0<g.length&&this.evalDependenceHor(a,b,d,k,c[e[g]])}"s"==a.sizeWidth?this.applyFixedSizeHor(a):"sp"==a.sizeWidth&&this.applyPercentHor(a,b,d);this.assignMarginsHor(a);a.leftChanged&&a.rightChanged?(this.assignSizeHor(a,d),this.assignGravityHor(a,d),0<a.childrenOrderHor.length&&(b=a.scrollHorizontal?0:a.width-a.paddingLeft-a.paddingRight,this.calculateViewsHor(a.childrenOrderHor,
a,c,e,b,f),this.applyPaddingChildrenHor(a))):(0<a.childrenOrderHor.length?(b=a.scrollHorizontal?0:d,this.calculateViewsHor(a.childrenOrderHor,a,c,e,b,f),this.applyPaddingChildrenHor(a),this.applySizeChildrenHor(a)):this.applySizeContentHor(a),this.assignSizeHor(a,d),this.assignGravityHor(a,d));this.applyScrollHor(a,d)&&(a.paddingBottom+=this.scrollWidth,a.scrollHorizontalApplied=!0,f.push(a))};
UICore.prototype.calculateViewsVer=function(a,b,c,e,d,f){for(var h=0;h<a.length;h++)a[h].hasToBeCalculated()&&this.calculateViewVer(a[h],b,c,e,d,f)};
UICore.prototype.calculateViewVer=function(a,b,c,e,d,f){for(var h=a.getReferencesVer(),k=0;k<h.length;k++){var g=this.calculateViewDependency(a,h[k],b);0<g.length&&this.evalDependenceVer(a,b,d,k,c[e[g]])}"s"==a.sizeHeight?this.applyFixedSizeVer(a):"sp"==a.sizeHeight&&this.applyPercentVer(a,b,d);this.assignMarginsVer(a);a.topChanged&&a.bottomChanged?(this.assignSizeVer(a,d),this.assignGravityVer(a,d),0<a.childrenOrderVer.length&&(b=a.scrollVertical?0:a.height-a.paddingTop-a.paddingBottom,this.calculateViewsVer(a.childrenOrderVer,
a,c,e,b,f),this.applyPaddingChildrenVer(a))):(0<a.childrenOrderVer.length?(b=a.scrollVertical?0:d,this.calculateViewsVer(a.childrenOrderVer,a,c,e,b,f),this.applyPaddingChildrenVer(a),this.applySizeChildrenVer(a)):this.applySizeContentVer(a),this.assignSizeVer(a,d),this.assignGravityVer(a,d));this.applyScrollVer(a,d)&&(a.paddingRight+=this.scrollWidth,a.scrollVerticalApplied=!0,f.push(a))};UICore.prototype.assignSizeHor=function(a,b){a.right>b&&0<b&&(a.right=b);a.width=a.right-a.left};
UICore.prototype.assignSizeVer=function(a,b){a.bottom>b&&0<b&&(a.bottom=b);a.height=a.bottom-a.top};UICore.prototype.applyFixedSizeHor=function(a){a.rightChanged?(a.left=a.right-a.width,a.leftChanged=!0):(a.right=a.left+a.width,a.leftChanged=!0,a.rightChanged=!0)};UICore.prototype.applyFixedSizeVer=function(a){a.bottomChanged?(a.top=a.bottom-a.height,a.topChanged=!0):(a.bottom=a.top+a.height,a.topChanged=!0,a.bottomChanged=!0)};
UICore.prototype.applyPaddingChildrenHor=function(a){0!=a.paddingLeft&&a.forEachChild(function(b,c){b.left+=a.paddingLeft;b.right+=a.paddingLeft})};UICore.prototype.applyPaddingChildrenVer=function(a){0!=a.paddingTop&&a.forEachChild(function(b,c){b.top+=a.paddingTop;b.bottom+=a.paddingTop})};
UICore.prototype.applyScrollHor=function(a,b){if(a.scrollHorizontal){var c=0;a.forEachChild(function(a,b){a.right>c&&(c=a.right)});if(c>b+a.paddingLeft&&!a.scrollHorizontalApplied)return document.getElementById(a.id).style.overflowX="auto",!0}return!1};
UICore.prototype.applyScrollVer=function(a,b){if(a.scrollVertical){var c=0;a.forEachChild(function(a,b){a.bottom>c&&(c=a.bottom)});if(("sc"!=a.sizeHeight||c>b+a.paddingTop)&&!a.scrollVerticalApplied)return document.getElementById(a.id).style.overflowY="auto",!0}return!1};UICore.prototype.applySizeContentHor=function(a){a.rightChanged?(a.left=a.right-a.width,a.leftChanged=!0):0<=a.right&&(a.right=a.left+a.width,a.rightChanged=!0,a.leftChanged=!0)};
UICore.prototype.applySizeContentVer=function(a){if(a.bottomChanged)a.top=a.bottom-a.height,a.topChanged=!0;else if(0<=a.bottom){var b=document.getElementById(a.id);b.style.width=a.width+"px";a.height=b.offsetHeight;a.bottom=a.top+a.height;a.bottomChanged=!0;a.topChanged=!0}};
UICore.prototype.applySizeChildrenHor=function(a){var b=0;a.forEachChild(function(a,e){a.right>b&&(b=a.right)});a.rightChanged?a.left=a.right-b-a.paddingLeft:(a.right=a.left+b+a.paddingRight,a.rightChanged=!0);a.leftChanged=!0;a.forEachChild(function(a,e){0>a.width&&(a.right=b,a.width=a.right-a.left)})};
UICore.prototype.applySizeChildrenVer=function(a){var b=0;a.forEachChild(function(a,e){a.bottom>b&&(b=a.bottom)});a.bottomChanged?(a.top=a.bottom-b-a.paddingTop,a.topChanged=!0):(a.bottom=a.top+b+a.paddingBottom,a.bottomChanged=!0);a.forEachChild(function(a,e){0>a.height&&(a.bottom=b,a.height=a.bottom-a.top)})};
UICore.prototype.applyPercentHor=function(a,b,c){a.rightChanged&&!a.leftChanged?a.left=a.right-b.width*a.percentWidth/100:a.right=a.left+b.width*a.percentWidth/100;0<a.percentLeft&&(b=(a.right-a.left)*a.percentLeft,a.left+=b,a.right+=b);a.rightChanged=!0;a.leftChanged=!0};
UICore.prototype.applyPercentVer=function(a,b,c){a.bottomChanged&&!a.topChanged?a.top=a.bottom-b.height*a.percentHeight/100:a.bottom=a.top+b.height*a.percentHeight/100;0<a.percentTop&&(b=(a.bottom-a.top)*a.percentTop,a.top+=b,a.bottom+=b);a.bottomChanged=!0;a.topChanged=!0};
UICore.prototype.assignGravityHor=function(a,b){"n"!=a.gravityHor&&("l"==a.gravityHor?(a.left=0,a.leftChanged=!0):"r"==a.gravityHor?(a.right=b,a.left=a.right-a.width):"c"==a.gravityHor&&(a.left=(b-a.width)/2,a.right=a.left+a.width,a.leftChanged=!0,a.rightChanged=!0))};
UICore.prototype.assignGravityVer=function(a,b){"n"!=a.gravityVer&&("t"==a.gravityVer?(a.top=0,a.topChanged=!0):"b"==a.gravityVer?(a.bottom=b,a.top=a.bottom-a.height):"c"==a.gravityVer&&(a.top=(b-a.height)/2,a.bottom=a.top+a.height,a.topChanged=!0,a.bottomChanged=!0))};
UICore.prototype.assignMarginsHor=function(a){var b=a.marginLeft,c=a.marginRight;0!=b&&a.leftChanged&&(a.left+=b,a.rightChanged&&"s"!=a.sizeWidth||(a.right+=b));0!=c&&a.rightChanged&&(a.right-=c,a.leftChanged&&"s"!=a.sizeWidth||(a.left-=c))};
UICore.prototype.assignMarginsVer=function(a){var b=a.marginTop,c=a.marginBottom;0!=a.marginTop&&a.topChanged&&(a.top+=b,a.bottomChanged&&"s"!=a.sizeHeight||(a.bottom+=b));0!=a.marginBottom&&a.bottomChanged&&(a.bottom-=c,a.topChanged&&"s"!=a.sizeHeight||(a.top-=c))};
UICore.prototype.evalDependenceHor=function(a,b,c,e,d){if(null==d)logE("The view '"+a.id+"' has a wrong reference");else switch(e){case 0:b!=d&&(a.left=d.left);a.leftChanged=!0;break;case 1:a.left=d.rightChanged?d.right:d.left+d.width;a.leftChanged=!0;break;case 2:if(b==d)if(b.rightChanged)a.right=c;else{a.right=-1;break}else a.right=d.rightChanged?d.right:d.left+d.width;a.rightChanged=!0;break;case 3:a.right=d.left,a.rightChanged=!0}};
UICore.prototype.evalDependenceVer=function(a,b,c,e,d){if(null==d)logE("The view '"+a.id+"' has a wrong reference");else switch(e){case 0:b!=d&&(a.top=d.top);a.topChanged=!0;break;case 1:a.top=d.bottomChanged?d.bottom:d.top+d.height;a.topChanged=!0;break;case 2:if(b==d)if(b.bottomChanged)a.bottom=c;else{a.bottom=-1;break}else a.bottom=d.bottomChanged?d.bottom:d.top+d.height;a.bottomChanged=!0;break;case 3:a.bottom=d.top,a.bottomChanged=!0}};
UICore.prototype.calculateViewDependency=function(a,b,c){return"p"==b?c.id:"l"==b?(a=a.getPreviousView(),null==a?"":a.id):b};var UIViewUtilsInstance=new UIViewUtils,UIUtilsInstance=new UIUtils;
function WebUI(){this.scrollHeight=this.scrollWidth=0;this.screens=[];this.nodesAdded=[];this.nodesRemoved=[];this.uiPrepare=new UIPrepare(this.refresh.bind(this));this.uiDraw=new UIDraw;this.configuration=this.uiCore=null;this.redrawTimer=new UIRedrawTimer;this.redraw=function(){this.redrawTimer.timer(function(){for(;0<this.nodesAdded.length;){var a=this.nodesAdded[0];this.nodesAdded.splice(0,1);this.uiPrepare.generateUIViews(a,this.configuration,this.screens);if(a=a.ui?a.ui.parent:null)if(a.childrenInOrder=
!1,"sc"==a.sizeWidth||"sc"==a.sizeHeight)a.sizeLoaded=!1}this.drawScreens()}.bind(this),this.configuration.timeRedraw)}.bind(this);this.resize=function(){this.configuration.refreshScreenSize();this.clearUI();this.redraw()}.bind(this)}
WebUI.prototype.start=function(a){this.clearUI();0==this.scrollWidth&&(this.scrollWidth=getScrollWidth());this.configuration=new UIConfiguration(a);uiShowLogs=this.configuration.showLogs;uiViewLogs=this.configuration.logsView;this.uiCore=new UICore(this.scrollWidth);this.drawScreens();this.listenDomEvents()};
WebUI.prototype.listenDomEvents=function(){var a=this;document.getElementsByTagName("BODY")[0].addEventListener("DOMNodeInserted",function(b){a.nodesAdded.push(b.srcElement);a.redraw()},!1);document.getElementsByTagName("BODY")[0].addEventListener("DOMNodeRemoved",function(a){},!1);window.removeEventListener("resize",this.resize);window.addEventListener("resize",this.resize)};
WebUI.prototype.clearUI=function(){var a=function(b){if(b.ui&&(delete b.ui,b=b.childNodes))for(var c=0;c<b.length;c++)a(b[c])};this.screens&&(this.screens.forEach(function(b){a(b.element)}),this.screens=[])};WebUI.prototype.refresh=function(){this.redraw()};WebUI.prototype.drawScreens=function(){startCounter("all");if(0==this.screens.length){var a=document.getElementsByTagName("BODY")[0];this.uiPrepare.generateUIViews(a,this.configuration,this.screens)}for(a=0;a<this.screens.length;a++)this.drawUIScreen(this.screens[a])};
WebUI.prototype.drawUIScreen=function(a){startCounter("prepare");startCounter("loadSizes");this.configuration.sendStartEvent();var b=this.uiPrepare.loadSizeScreen(a);a.hasToBeCalculated()&&(this.uiPrepare.loadSizes(a.getChildElements(),this.configuration,b),endCounterLog("loadSizes"),startCounter("orderViews"),this.uiPrepare.orderViews(a),endCounterLog("orderViews"),endCounterLog("prepare"),startCounter("core"),this.uiCore.calculateScreen(a),endCounterLog("core"));startCounter("draw");b=this.uiDraw.applyPositions(a,
this.configuration.viewColors);this.uiDraw.applySizeScreen(a,b.maxX,b.maxY);endCounterLog("draw");this.configuration.sendEndEvent();endCounterLog("all")};var WebUIInstance=new WebUI;window.WebUI=WebUIInstance;window.WebUI.start=WebUIInstance.start;window.WebUI.refresh=WebUIInstance.refresh;
