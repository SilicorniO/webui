(()=>{"use strict";const t=function(){function t(){}return t.calculateWidthView=function(t,e){t.style.position="fixed",e&&(t.style.height=e+"px"),t.style.width="auto";var n=t.getBoundingClientRect();return Math.ceil(n.width)},t.calculateHeightView=function(t,e){t.style.position="fixed",e&&(t.style.width=e+"px"),t.style.height="auto";var n=t.getBoundingClientRect();return Math.ceil(n.height)},t.generateIndexes=function(t){for(var e={},n=0;n<t.length;n++)t[n].id&&(e[t[n].id]=n);return e},t.generateArrayViews=function(t,e){null==e&&(e=new Array),e.push(t);for(var n=0,i=t.getUIChildren();n<i.length;n++){var r=i[n];this.generateArrayViews(r,e)}return e},t}();var e;!function(t){t.X="x",t.Y="y"}(e||(e={}));var n,i,r=[e.X,e.Y],a=function(){function t(){this.start=0,this.end=0}return t.prototype.size=function(){return this.end-this.start},t.prototype.clean=function(){this.start=0,this.end=0},t}();!function(t){t.NONE="",t.SCREEN="s",t.PARENT="p",t.LAST="l"}(n||(n={})),function(t){t[t.START_START=0]="START_START",t[t.START_END=1]="START_END",t[t.END_END=2]="END_END",t[t.END_START=3]="END_START",t[t.CENTER=4]="CENTER"}(i||(i={}));var s,o,h=[i.START_START,i.START_END,i.END_END,i.END_START,i.CENTER];!function(t){t.SIZE_CONTENT="sc",t.SCREEN="s",t.PERCENTAGE="sp"}(s||(s={})),function(t){t.HIDDEN="h",t.SCROLL="s",t.VISIBLE="v"}(o||(o={}));const l=function(){function t(){this.startStart="",this.startEnd="",this.endEnd="",this.endStart="",this.size=s.SIZE_CONTENT,this.sizeValue=0,this.percentPos=0,this.overflow=o.HIDDEN,this.center="",this.marginStart="",this.marginEnd="",this.paddingStart="",this.paddingEnd=""}return t.prototype.getRef=function(t){switch(t){case i.START_START:return this.startStart;case i.START_END:return this.startEnd;case i.END_END:return this.endEnd;case i.END_START:return this.endStart;case i.CENTER:return this.center;default:return""}},t.prototype.setRef=function(t,e){switch(t){case i.START_START:return void(this.startStart=e);case i.START_END:return void(this.startEnd=e);case i.END_END:return void(this.endEnd=e);case i.END_START:return void(this.endStart=e);case i.CENTER:return void(this.center=e);default:return}},t.prototype.setSize=function(t){if(t==s.SIZE_CONTENT)this.size=t,this.sizeValue=0;else if(-1!=String(t).indexOf("%")){var e=t.indexOf("%");this.sizeValue=parseFloat(t.substring(0,e)),e<t.length-1&&(this.percentPos=parseInt(t.substring(e+1,t.length),10)),this.size=s.PERCENTAGE}else this.sizeValue=parseFloat(t),this.size=s.SCREEN},t.prototype.setMargin=function(t){this.marginStart=t,this.marginEnd=t},t.prototype.setPadding=function(t){this.paddingStart=t,this.paddingEnd=t},t.prototype.clean=function(t){null!=t&&0==t.position||(this.startStart="",this.startEnd="",this.endEnd="",this.endStart=""),null!=t&&0==t.size||(this.size=s.SIZE_CONTENT,this.sizeValue=0,this.percentPos=0),null!=t&&0==t.overflow||(this.overflow=o.HIDDEN),null!=t&&0==t.center||(this.center=""),null!=t&&0==t.margin||(this.marginStart="",this.marginEnd=""),null!=t&&0==t.position||(this.paddingStart="",this.paddingEnd="")},t.prototype.clone=function(){var e=new t;return e.startStart=this.startStart,e.startEnd=this.startEnd,e.endEnd=this.endEnd,e.endStart=this.endStart,e.size=this.size,e.sizeValue=this.sizeValue,e.percentPos=this.percentPos,e.overflow=this.overflow,e.center=this.center,e.marginStart=this.marginStart,e.marginEnd=this.marginEnd,e.paddingStart=this.paddingStart,e.paddingEnd=this.paddingEnd,e},t}();var d;!function(t){t[t.NONE=0]="NONE",t[t.DOM=1]="DOM",t[t.PREPARE=2]="PREPARE",t[t.ORGANIZE=3]="ORGANIZE",t[t.CALCULATE=4]="CALCULATE",t[t.DRAW=5]="DRAW"}(d||(d={}));const c=function(){function n(){}return n.prepareScreen=function(t,e){t.getState()>=d.PREPARE||(null==t.parent&&n.loadSizeScreen(t),n.loadSizes(t.getChildElements(),e),t.setState(d.PREPARE))},n.loadSizes=function(n,i){for(var r=0;r<n.length;r++){var a=n[r],o=a.ui;o.getState()<d.PREPARE&&(o.isGone()||("none"==a.style.display&&(a.style.display="inline-block"),o.attrs[e.X].size!=s.SIZE_CONTENT||o.hasUIChildren()||(o.attrs[e.X].sizeValue=t.calculateWidthView(a)),o.attrs[e.Y].size!=s.SIZE_CONTENT||o.hasUIChildren()||(o.attrs[e.Y].sizeValue=t.calculateHeightView(a)),this.loadSizes(o.getChildElements(),i)),o.setState(d.PREPARE))}},n.loadSizeScreen=function(t){var n=t.element;"none"==n.style.display&&(n.style.display="inline-block");var i=t.hasUIChildren();this.calculateScreenPosition(n,e.X,t.attrs[e.X],t.positions[e.X],i),this.calculateScreenPosition(n,e.Y,t.attrs[e.Y],t.positions[e.Y],i),n.style.position="relative"},n.calculateScreenPosition=function(n,i,r,a,o){if(a.clean(),r.size==s.SIZE_CONTENT){if(o)return;i==e.X?a.size=t.calculateWidthView(n):i==e.Y&&(a.size=t.calculateHeightView(n))}else{var h="";r.size==s.SCREEN?h=r.sizeValue+"px":r.size==s.PERCENTAGE&&(h=r.sizeValue+"%");var l=0;i==e.X?(n.style.width=h,l=Math.ceil(n.getBoundingClientRect().width)):i==e.Y&&(n.style.height=h,l=Math.ceil(n.getBoundingClientRect().height)),l!=a.size&&(a.size=l)}a.end=a.size,a.endChanged=!0,a.startChanged=!0},n}(),u=function(){function t(e,n){void 0===n&&(n=t.DELAY_DEFAULT),this.timeNextExecution=null,this.timeoutRunning=!1,this.cbExecution=e,this.delay=n}return t.prototype.execute=function(){var t=this;if(null!=this.timeNextExecution&&0!=this.delay){var e=(new Date).getTime();e>this.timeNextExecution?this.callToExecute():this.timeoutRunning||(this.timeoutRunning=!0,setTimeout((function(){t.timeoutRunning=!1,t.execute()}),this.timeNextExecution-e))}else this.callToExecute()},t.prototype.callToExecute=function(){this.timeNextExecution=(new Date).getTime()+this.delay,this.cbExecution()},t.DELAY_DEFAULT=20,t}();var E;!function(t){t[t.INFO=0]="INFO",t[t.WARNING=1]="WARNING",t[t.ERROR=2]="ERROR",t[t.DEBUG=3]="DEBUG"}(E||(E={}));const g=function(){function t(){}return t.log=function(e){t.logShow(E.DEBUG,e)},t.logW=function(e){t.logShow(E.WARNING,e)},t.logE=function(e){t.logShow(E.ERROR,e)},t.logI=function(e){t.logShow(E.INFO,e)},t.logIView=function(e,n){t.logI("["+e+"] "+n.toString());for(var i=0,r=n.getUIChildren();i<r.length;i++){var a=r[i];t.logIView(e,a)}},t.logShow=function(e,n){if(t.uiShowLogs){var i=n;switch(e){case E.DEBUG:i="DEBUG: "+i;break;case E.WARNING:i="WARNING: "+i;break;case E.ERROR:i="ERROR: "+i;break;case E.INFO:i="INFO: "+i}console.log(i),t.uiViewLogs&&(t.uiViewLogs.innerHTML+=i+"<BR />")}},t.uiShowLogs=!1,t.uiViewLogs=null,t}(),f=function(){function t(e){if(this.attribute=t.ATTRIBUTE_DEFAULT,this.attributes=[],this.dimens={},this.selectedDimens={},this.timeRedraw=t.TIME_REDRAW_DEFAULT,this.viewColors=!1,this.showLogs=!1,this.screenModes=[],this.animations={defaultTime:t.ANIMATION_TIME_DEFAULT,defaultOpacity:t.ANIMATION_OPACITY_DEFAULT},this.sendEndEvent=function(){this.events&&this.events({name:t.EVENT_END,attributes:this.attributes})},null!=e){if(1==e.viewColors&&(this.viewColors=!0),1==e.showLogs&&(this.showLogs=!0,e.viewLogs&&(this.logsView=document.getElementById(e.viewLogs)||void 0)),null!=e.events&&(this.events=e.events),null!=e.animations){var n=e.animations;null!=n.defaultTime&&(this.animations.defaultTime=n.defaultTime),null!=n.defaultOpacity&&(this.animations.defaultOpacity=n.defaultOpacity)}if(null==e.timeRedraw||isNaN(e.timeRedraw)||(this.timeRedraw=e.timeRedraw),e.attribute&&(this.attribute=e.attribute),this.dimens={},e.dimens)for(var i=Object.keys(e.dimens),r=0;r<i.length;r++)this.dimens[i[r]]=e.dimens[i[r]];null!=e.screenModes&&(this.screenModes=e.screenModes),this.refreshScreenSize()}}return t.prototype.refreshScreenSize=function(){var t=[],e=this.dimens,n=window.innerWidth,i=window.innerHeight;if(g.log("screen-width: "+n),g.log("screen-height: "+i),this.screenModes)for(var r=0;r<this.screenModes.length;r++){var a=this.screenModes[r];if((null==a.widthStart||0==a.widthStart||n>=a.widthStart)&&(null==a.widthEnd||0==a.widthEnd||n<a.widthEnd)&&(null==a.heightStart||0==a.heightStart||i>=a.heightStart)&&(null==a.heightEnd||0==a.heightEnd||i<a.heightEnd)){var s=a.attribute;if(null!=s&&(t.push(s),g.log("SHOWING ATTRIBUTE: "+s)),a.dimens)for(var o=Object.keys(a.dimens),h=0;h<o.length;h++)e[o[h]]=a.dimens[o[h]]}}this.attributes=t,this.selectedDimens=e},t.prototype.getDimen=function(t){return 0===t.length?0:this.selectedDimens[t]?this.selectedDimens[t]:t&&!isNaN(parseInt(t,10))?parseInt(t,10):(g.logE("The dimension '"+t+"' is not valid or it is not defined"),0)},t.prototype.sendStartEvent=function(){this.events&&this.events({name:t.EVENT_START})},t.TIME_REDRAW_DEFAULT=20,t.ATTRIBUTE_DEFAULT="ui",t.ANIMATION_TIME_DEFAULT=.3,t.ANIMATION_OPACITY_DEFAULT=!1,t.EVENT_START="start",t.EVENT_END="end",t}(),p=function(){function t(){}return t.getScrollWidth=function(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return n==i&&(i=e.clientWidth),document.body.removeChild(e),n-i},t.getPreviousElementWithAttribute=function(e,n){if(n.hasAttribute(e))return n;var i=n.parentElement;return null==i?null:t.getPreviousElementWithAttribute(e,i)},t}(),T=function(){function t(){}return t.startCounter=function(e){var n=(new Date).getTime();t.counters[e]=n},t.endCounter=function(e){return(new Date).getTime()-t.counters[e]},t.endCounterLog=function(e){g.log("Counter["+e+"]: "+t.endCounter(e)+"ms")},t.counters={},t}();var v;!function(t){t.VISIBLE="v",t.INVISIBLE="i",t.GONE="g"}(v||(v={}));var S=function(){this.duration=0,this.onEnd=null};const A=function(){this.left="",this.top="",this.width="",this.height="",this.display="",this.opacity="",this.transition="",this.overflowX="",this.overflowY="",this.backgroundColor="",this.onTransitionEnd=null},N=function(){function t(){}return t.generateScreenDraw=function(t,e,n,i){var r=new A;return this.applyBackground(i,r),this.applyVisibility(t,r,n),this.applySize(e,r),this.applyOverflow(t,r),r},t.applySizeScreen=function(t,n,i,r){t[e.X].size==s.SCREEN?r.width=Math.max(0,n[e.X].end-n[e.X].start)+"px":t[e.X].size==s.PERCENTAGE?r.width=t[e.X].sizeValue+"%":i.x>0?r.width=i.x+"px":r.width=n[e.X].size+"px",t[e.Y].size==s.SCREEN?r.height=Math.max(0,n[e.Y].end-n[e.Y].start)+"px":t[e.Y].size==s.PERCENTAGE?r.height=t[e.Y].sizeValue+"%":i.y>0?r.height=i.y+"px":r.height=n[e.Y].size+"px"},t.generateChildDraw=function(t,e,n,i,r,a){var s=new A;this.applyBackground(a,s);var o=this.applyPosition(e,s);return this.applyVisibility(t,s,r,i),this.applyAnimation(n,s),this.applyOverflow(t,s),{maxPosition:o,draw:s}},t.applyBackground=function(t,e){t&&(e.backgroundColor=this.generateRandomViewColor())},t.applyAnimation=function(t,e){if(t.length>0){var n=t[0];t.splice(0,1),e.transition="all "+n.duration+"s ease 0s",e.onTransitionEnd=n.onEnd}},t.applySize=function(t,n){var i=Math.max(0,t[e.X].end-t[e.X].start),r=Math.max(0,t[e.Y].end-t[e.Y].start);n.width=i+"px",n.height=r+"px"},t.applyPosition=function(t,n){var i=t[e.X].start,r=t[e.Y].start,a=Math.max(0,t[e.X].end-t[e.X].start),s=Math.max(0,t[e.Y].end-t[e.Y].start);return n.left=i+"px",n.top=r+"px",n.width=a+"px",n.height=s+"px",{x:i+a,y:r+s}},t.applyVisibility=function(t,e,n,i){"g"==t.visibility||i==v.GONE?(e.display="none",e.opacity="0"):(e.display="inline-block",t.visibility==v.INVISIBLE||i==v.INVISIBLE?e.opacity="0":e.opacity=n.opacity||"1")},t.applyOverflow=function(t,n){var i=t[e.X].overflow,r=t[e.Y].overflow;switch(i){case o.VISIBLE:n.overflowX="visible";break;case o.SCROLL:n.overflowX="scroll";break;case o.HIDDEN:default:n.overflowX="hidden"}switch(r){case o.VISIBLE:n.overflowY="visible";break;case o.SCROLL:n.overflowY="scroll";break;case o.HIDDEN:default:n.overflowY="hidden"}},t.generateRandomViewColor=function(){return"rgba("+parseInt(""+255*Math.random(),10)+","+parseInt(""+255*Math.random(),10)+","+parseInt(""+255*Math.random(),10)+",0.4)"},t}(),I=function(){function t(){}return t.drawScreen=function(t,e,n){this.drawBackground(t,e),this.drawSize(t,e),this.drawVisibility(t,e,n)},t.drawView=function(t,e,n){this.drawBackground(t,e),this.drawChildCommon(t,e),this.drawTransition(t,e),this.drawPosition(t,e),this.drawSize(t,e),this.drawOverflow(t,e),this.drawVisibility(t,e,n)},t.drawBackground=function(t,e){e.backgroundColor.length>0&&(t.style.backgroundColor=e.backgroundColor)},t.drawChildCommon=function(t,e){t.style.display=e.display,t.style.margin="auto",t.childElementCount>0&&(t.style.padding="0px")},t.drawTransition=function(t,e){var n=t.style.transition.length>0;if((e.transition.length>0||!n)&&(t.style.transition=e.transition),e.transition.length>0&&!n){var i=function(n){t.style.transition="",t.removeEventListener("transitionend",i),null!=e.onTransitionEnd&&setTimeout((function(){null!=e.onTransitionEnd&&e.onTransitionEnd()}),0)};t.addEventListener("transitionend",i)}},t.drawPosition=function(t,e){t.style.left=e.left,t.style.top=e.top,t.style.position="absolute"},t.drawSize=function(t,e){t.style.width=e.width,t.style.height=e.height},t.drawOverflow=function(t,e){t.style.overflowX=e.overflowX,t.style.overflowY=e.overflowY},t.drawVisibility=function(t,e,n){var i=t.style.opacity;n.defaultOpacity&&e.opacity!=i&&(t.style.transition="opacity "+n.defaultTime+"s ease 0s"),t.style.opacity=e.opacity},t}(),w=function(){function t(){}return t.generateDraws=function(t,e){if(!(t.getState()>=d.DRAW)){var n={x:0,y:0};if(null==t.parent){for(var i=0,r=t.getUIChildren();i<r.length;i++){var a=r[i],s=this.generateDrawOfView(a,t.attrs.visibility,e);n.x=Math.max(n.x,s.x),n.y=Math.max(n.y,s.y)}var o=N.generateScreenDraw(t.attrs,t.positions,t.userStyles,e.viewColors);t.draw=o}else this.generateDrawOfView(t,t.attrs.visibility,e);t.setState(d.DRAW)}},t.generateDrawOfView=function(t,n,i){for(var r=0,a=t.getUIChildren();r<a.length;r++){var s=a[r];this.generateDrawOfView(s,n,i)}if(t.getState()>=d.DRAW)return{x:t.positions[e.X].start+t.positions[e.X].size,y:t.positions[e.Y].start+t.positions[e.Y].size};var o=N.generateChildDraw(t.attrs,t.positions,t.animations,n,t.userStyles,i.viewColors);return t.draw=o.draw,t.setState(d.DRAW),o.maxPosition},t.applyDraws=function(t,e){for(var n=0,i=t.getUIChildren();n<i.length;n++){var r=i[n];this.applyDrawToView(r,e)}null==t.parent?I.drawScreen(t.element,t.draw,e.animations):this.applyDrawToView(t,e)},t.applyDrawToView=function(t,e){for(var n=0,i=t.getUIChildren();n<i.length;n++){var r=i[n];this.applyDrawToView(r,e)}I.drawView(t.element,t.draw,e.animations)},t}();var R,D=(R=function(t,e){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}R(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});const y=function(t){function e(){return t.call(this)||this}return D(e,t),e.convert=function(t,e){var n=t;return n.ui=e,n},e.get=function(t){return null==t[U.UI_TAG]?null:t},e.getAll=function(t){var n=[];if(t instanceof Array)for(var i=0,r=t;i<r.length;i++){var a=r[i],s=e.get(a);null!=s&&n.push(s)}else t.forEach((function(t){var i=e.get(t);null!=i&&n.push(i)}));return n},e.convertToUIView=function(t){for(var e=[],n=0,i=t;n<i.length;n++){var r=i[n];e.push(r.ui)}return e},e}(HTMLElement),O=function(){function t(){this.size=0,this.start=0,this.end=0,this.center=0,this.startChanged=!1,this.endChanged=!1,this.centerChanged=!1,this.scrollApplied=!1,this.marginStart=0,this.marginEnd=0,this.paddingStart=0,this.paddingEnd=0}return t.prototype.clean=function(){this.startChanged=!1,this.endChanged=!1,this.centerChanged=!1,this.scrollApplied=!1,this.start=0,this.end=0,this.size=0},t.prototype.clone=function(){var e=new t;return e.size=this.size,e.start=this.start,e.end=this.end,e.center=this.center,e.startChanged=this.startChanged,e.endChanged=this.endChanged,e.centerChanged=this.centerChanged,e.scrollApplied=this.scrollApplied,e.marginStart=this.marginStart,e.marginEnd=this.marginEnd,e.paddingStart=this.paddingStart,e.paddingEnd=this.paddingEnd,e},t}(),C=function(){function t(){this.x=new l,this.y=new l,this.visibility=v.VISIBLE}return t.prototype.getAxis=function(t){switch(t){case e.X:return this.x;case e.Y:return this.y;default:return new l}},t.prototype.clean=function(t){this.x.clean(t),this.y.clean(t),this.visibility=v.VISIBLE},t.prototype.clone=function(){var e=new t;return e.x=this.x.clone(),e.x=this.y.clone(),e.visibility=this.visibility,e},t}(),_=function(){function t(){}return t.readAttributes=function(t){if(null==t)return[];for(var e=t.replace(" ","").split(";"),n=[],i=0;i<e.length;i++){var r=e[i].split(":");2==r.length?n.push({attr:r[0],value:r[1]}):1==r.length&&n.push({attr:r[0]})}return n},t.isReferenceEmpty=function(t){for(var e=0,n=h;e<n.length;e++){var i=n[e];if(t.getRef(i).length>0)return!1}return!0},t}();var L;!function(t){t.NONE="",t.WIDTH="w",t.FULL_WIDTH="fw",t.HEIGHT="h",t.FULL_HEIGHT="fh",t.LEFT="l",t.RIGHT="r",t.TOP="t",t.BOTTOM="b",t.AT_LEFT="al",t.AT_LEFT_EQUAL="ale",t.AT_RIGHT="ar",t.AT_RIGHT_EQUAL="are",t.AT_TOP="at",t.AT_TOP_EQUAL="ate",t.AT_BOTTOM="ab",t.AT_BOTTOM_EQUAL="abe",t.MARGIN_LEFT="ml",t.MARGIN_TOP="mt",t.MARGIN_RIGHT="mr",t.MARGIN_BOTTOM="mb",t.MARGIN="m",t.PADDING_LEFT="pl",t.PADDING_RIGHT="pr",t.PADDING_TOP="pt",t.PADDING_BOTTOM="pb",t.PADDING="p",t.CENTER_VERTICAL="cv",t.CENTER_HORIZONTAL="ch",t.CENTER="c",t.OVERFLOW="o",t.OVERFLOW_VERTICAL="ov",t.OVERFLOW_HORIZONTAL="oh",t.SCROLL_VERTICAL="sv",t.SCROLL_HORIZONTAL="sh",t.VISIBILITY="v"}(L||(L={}));const m=function(){function t(){}return t.readAttrs=function(t,e){var n=e.attribute,i=e.attributes,r=new C;return this.readUI(r,t,n,i),r},t.readUI=function(t,e,n,i){for(var r=_.readAttributes(e.getAttribute(n)),a=0;a<i.length;a++)r=r.concat(_.readAttributes(e.getAttribute(i[a])));if(0!=r.length)for(var s=0,o=r;s<o.length;s++){var h=o[s];this.readUIAttribute(t,h,e.id)}},t.readUIAttribute=function(t,e,r){var a=e.attr,s=e.value,h="",l=null;switch(null!=s&&(!0===s||!1===s?l=s:h=""+s),a){case L.WIDTH:t.x.setSize(h);break;case L.FULL_WIDTH:t.x.setSize("100%");break;case L.HEIGHT:t.y.setSize(h);break;case L.FULL_HEIGHT:t.y.setSize("100%");break;case L.LEFT:t.x.setRef(i.START_START,h);break;case L.RIGHT:t.x.setRef(i.END_END,h);break;case L.TOP:t.y.setRef(i.START_START,h);break;case L.BOTTOM:t.y.setRef(i.END_END,h);break;case L.AT_LEFT:t.x.setRef(i.END_START,h);break;case L.AT_LEFT_EQUAL:t.x.setRef(i.END_START,h),t.y.setRef(i.START_START,h),t.y.setRef(i.END_END,h);break;case L.AT_RIGHT:t.x.setRef(i.START_END,h);break;case L.AT_RIGHT_EQUAL:t.x.setRef(i.START_END,h),t.y.setRef(i.START_START,h),t.y.setRef(i.END_END,h);break;case L.AT_TOP:t.y.setRef(i.END_START,h);break;case L.AT_TOP_EQUAL:t.y.setRef(i.END_START,h),t.x.setRef(i.START_START,h),t.x.setRef(i.END_END,h);break;case L.AT_BOTTOM:t.y.setRef(i.START_END,h);break;case L.AT_BOTTOM_EQUAL:t.y.setRef(i.START_END,h),t.x.setRef(i.START_START,h),t.x.setRef(i.END_END,h);break;case L.MARGIN_LEFT:t.x.marginStart=h;break;case L.MARGIN_RIGHT:t.x.marginEnd=h;break;case L.MARGIN_TOP:t.y.marginStart=h;break;case L.MARGIN_BOTTOM:t.y.marginEnd=h;break;case L.MARGIN:var d=h.split(",");1===d.length?(t.x.setMargin(h),t.y.setMargin(h)):4===d.length&&(t.x.marginStart=d[0],t.y.marginStart=d[1],t.x.marginEnd=d[2],t.y.marginEnd=d[3]);break;case L.PADDING_LEFT:t.x.paddingStart=h;break;case L.PADDING_RIGHT:t.x.paddingEnd=h;break;case L.PADDING_TOP:t.y.paddingStart=h;break;case L.PADDING_BOTTOM:t.y.paddingEnd=h;break;case L.PADDING:var c=h.split(",");1===c.length?(t.x.setPadding(h),t.y.setPadding(h)):4===c.length&&(t.x.paddingStart=c[0],t.y.paddingStart=c[1],t.x.paddingEnd=c[2],t.y.paddingEnd=c[3]);break;case L.CENTER_VERTICAL:h.length>0?t.y.center=h:t.y.center=0==l?"":n.PARENT;break;case L.CENTER_HORIZONTAL:h.length>0?t.x.center=h:t.x.center=0==l?"":n.PARENT;break;case L.CENTER:h.length>0?(t.x.center=h,t.y.center=h):null==s||!0===l?(t.x.center=n.PARENT,t.y.center=n.PARENT):(t.x.center="",t.y.center="");break;case L.OVERFLOW:t.x.overflow=h,t.y.overflow=h;break;case L.OVERFLOW_VERTICAL:t.y.overflow=h;break;case L.OVERFLOW_HORIZONTAL:t.x.overflow=h;break;case L.SCROLL_VERTICAL:t.y.overflow=null==l||1==l?o.SCROLL:o.HIDDEN;break;case L.SCROLL_HORIZONTAL:t.x.overflow=null==l||1==l?o.SCROLL:o.HIDDEN;break;case L.VISIBILITY:t.visibility=h||v.VISIBLE;break;case L.NONE:break;default:g.logW("Attribute unknown: "+a+" in view "+r)}},t.generateUiAttr=function(t){var e=[];if(t.x.size==s.SCREEN)e.push(L.WIDTH+":"+t.x.sizeValue);else if(t.x.size==s.PERCENTAGE){var n=t.x.percentPos>0?""+t.x.percentPos:"";e.push(L.WIDTH+":"+t.x.sizeValue+"%"+n)}if(t.y.size==s.SCREEN?e.push(L.HEIGHT+":"+t.y.sizeValue):t.y.size==s.PERCENTAGE&&(n=t.y.percentPos>0?""+t.y.percentPos:"",e.push(L.HEIGHT+":"+t.y.sizeValue+"%"+n)),t.x.startStart.length>0&&e.push(L.LEFT+":"+t.x.startStart),t.x.startEnd.length>0&&e.push(L.AT_RIGHT+":"+t.x.startEnd),t.x.endEnd.length>0&&e.push(L.RIGHT+":"+t.x.endEnd),t.x.endStart.length>0&&e.push(L.AT_LEFT+":"+t.x.endStart),t.y.startStart.length>0&&e.push(L.TOP+":"+t.y.startStart),t.y.startEnd.length>0&&e.push(L.AT_BOTTOM+":"+t.y.startEnd),t.y.endEnd.length>0&&e.push(L.BOTTOM+":"+t.y.endEnd),t.y.endStart.length>0&&e.push(L.AT_TOP+":"+t.y.endStart),t.x.marginStart.length>0&&e.push(L.MARGIN_LEFT+":"+t.x.marginStart),t.x.marginEnd.length>0&&e.push(L.MARGIN_RIGHT+":"+t.x.marginEnd),t.y.marginStart.length>0&&e.push(L.MARGIN_TOP+":"+t.y.marginStart),t.y.marginEnd.length>0&&e.push(L.MARGIN_BOTTOM+":"+t.y.marginEnd),t.x.paddingStart.length>0&&e.push(L.PADDING_LEFT+":"+t.x.paddingStart),t.x.paddingEnd.length>0&&e.push(L.PADDING_RIGHT+":"+t.x.paddingEnd),t.y.paddingStart.length>0&&e.push(L.PADDING_TOP+":"+t.y.paddingStart),t.y.paddingEnd.length>0&&e.push(L.PADDING_BOTTOM+":"+t.y.paddingEnd),t.x.center.length>0&&e.push(L.CENTER_HORIZONTAL+":"+t.x.center),t.y.center.length>0&&e.push(L.CENTER_VERTICAL+":"+t.y.center),t.x.overflow.length>0&&t.x.overflow!=o.HIDDEN&&e.push(L.OVERFLOW_HORIZONTAL+":"+t.x.overflow),t.y.overflow.length>0&&t.y.overflow!=o.HIDDEN&&e.push(L.OVERFLOW_VERTICAL+":"+t.y.overflow),t.visibility==v.GONE?e.push(L.VISIBILITY+":"+v.GONE):t.visibility==v.INVISIBLE&&e.push(L.VISIBILITY+":"+v.INVISIBLE),0===e.length)return"";for(var i=e[0],r=1;r<e.length;r+=1)i+=";"+e[r];return i},t}(),b=function(){function t(){}return t.convertAttrToStateChangeWithAxis=function(t,n,i){switch(t){case L.WIDTH:case L.FULL_WIDTH:return[{stateChange:G.SIZE,axis:e.X}];case L.HEIGHT:case L.FULL_HEIGHT:return[{stateChange:G.SIZE,axis:e.Y}];case L.LEFT:case L.AT_RIGHT:case L.AT_RIGHT_EQUAL:return[{stateChange:G.START,axis:e.X}];case L.TOP:case L.AT_BOTTOM:case L.AT_BOTTOM_EQUAL:return[{stateChange:G.START,axis:e.Y}];case L.RIGHT:case L.AT_LEFT:case L.AT_LEFT_EQUAL:return[{stateChange:G.END,axis:e.X}];case L.BOTTOM:case L.AT_TOP:case L.AT_TOP_EQUAL:return[{stateChange:G.END,axis:e.Y}];case L.MARGIN_LEFT:return[{stateChange:G.MARGIN_START,axis:e.X}];case L.MARGIN_TOP:return[{stateChange:G.MARGIN_START,axis:e.Y}];case L.MARGIN_RIGHT:return[{stateChange:G.MARGIN_END,axis:e.X}];case L.MARGIN_BOTTOM:return[{stateChange:G.MARGIN_END,axis:e.Y}];case L.MARGIN:return[{stateChange:G.MARGIN_START,axis:e.X},{stateChange:G.MARGIN_END,axis:e.X},{stateChange:G.MARGIN_START,axis:e.Y},{stateChange:G.MARGIN_END,axis:e.Y}];case L.PADDING_LEFT:return[{stateChange:G.PADDING_START,axis:e.X}];case L.PADDING_TOP:return[{stateChange:G.PADDING_START,axis:e.Y}];case L.PADDING_RIGHT:return[{stateChange:G.PADDING_END,axis:e.X}];case L.PADDING_BOTTOM:return[{stateChange:G.PADDING_END,axis:e.Y}];case L.PADDING:return[{stateChange:G.PADDING_START,axis:e.X},{stateChange:G.PADDING_END,axis:e.X},{stateChange:G.PADDING_START,axis:e.Y},{stateChange:G.PADDING_END,axis:e.Y}];case L.CENTER_HORIZONTAL:return[{stateChange:G.CENTER,axis:e.X}];case L.CENTER_VERTICAL:return[{stateChange:G.CENTER,axis:e.Y}];case L.CENTER:return[{stateChange:G.CENTER,axis:e.X},{stateChange:G.CENTER,axis:e.Y}];case L.OVERFLOW_HORIZONTAL:case L.SCROLL_HORIZONTAL:return[{stateChange:G.OVERFLOW,axis:e.X}];case L.OVERFLOW_VERTICAL:case L.SCROLL_VERTICAL:return[{stateChange:G.OVERFLOW,axis:e.Y}];case L.OVERFLOW:return[{stateChange:G.OVERFLOW,axis:e.X},{stateChange:G.OVERFLOW,axis:e.Y}];case L.VISIBILITY:return n.visibility==v.GONE||i==v.GONE?[{stateChange:G.VISIBILITY_GONE}]:[{stateChange:G.VISIBILITY}];default:return[{stateChange:G.NONE}]}},t}(),x=function(){function t(t,e){this.dismissNextUiAttributeMutation=!1,this.view=t,this.configuration=e}return t.prototype.onChangeAttribute=function(t,e,n){this.dismissNextUiAttributeMutation=!0,this.view.element.setAttribute(this.configuration.attribute,m.generateUiAttr(this.view.attrs));for(var i=0,r=b.convertAttrToStateChangeWithAxis(t,e,n);i<r.length;i++){var a=r[i];this.view.changeState(a.stateChange,a.axis)}},t.prototype.onLoadElement=function(){this.view.changeState(G.ELEMENT_LOADED)},t.prototype.evalAttributeModified=function(t){t==this.configuration.attribute&&this.dismissNextUiAttributeMutation?this.dismissNextUiAttributeMutation=!1:(g.log("Event 'attributes' being processed for view "+this.view.id),this.view.changeState(G.ATTRIBUTE_MODIFIED))},t}(),V=function(){function t(){}return t.setLowerState=function(t,e){return!(e>=t.getState()||(t.setState(e),0))},t.setLowerStateToChildren=function(e,n){for(var i=0,r=e.getUIChildren();i<r.length;i++){var a=r[i];n<a.getState()&&a.setState(n),t.setLowerStateToChildren(a,n)}},t.setLowerStateToParents=function(e,n){var i=e.parent;if(null==i)return e;for(var a=!1,s=0,o=i.getUIChildren();s<o.length;s++){var h=o[s];if(h.id!=e.id)for(var l=0,d=r;l<d.length;l++){var c=d[l];if(h.dependencies[c].includes(e.id)){a=!0;break}}}return a?(n<i.getState()&&i.setState(n),t.setLowerStateToParents(i,n)):e},t.hasParentDependencyOfView=function(t){var n=t.parent;return null!=n&&(n.attrs[e.X].size===s.SIZE_CONTENT||n.attrs[e.Y].size===s.SIZE_CONTENT)},t.hasBrothersDependencOfView=function(t){var e=t.parent;if(null==e)return!1;for(var n=0,i=e.getUIChildren();n<i.length;n++){var a=i[n];if(a.id!=t.id)for(var s=0,o=r;s<o.length;s++){var h=o[s];if(a.dependencies[h].includes(t.id))return!0}}return!1},t}(),M=function(){function t(t,e){this.state=d.NONE,this.view=t,this.webUIListener=e}return t.prototype.changeState=function(t,e){var n=null;if(null!=e)switch(t){case G.SIZE:n=this.changeStateSize(e);break;case G.SIZE_POS:n=this.changeStateSizePos(e);break;case G.START:n=this.changeStateStart(e);break;case G.END:n=this.changeStateEnd(e);break;case G.CENTER:n=this.changeStateCenter(e);break;case G.MARGIN_START:n=this.changeStateMarginStart(e);break;case G.MARGIN_END:n=this.changeStateMarginEnd(e);break;case G.PADDING_START:case G.PADDING_END:n=this.changeStatePadding(e);break;case G.OVERFLOW:n=this.changeStateOverflow(e)}else switch(t){case G.VISIBILITY:n=this.changeStateVisibility();break;case G.VISIBILITY_GONE:n=this.changeStateVisibilityGone();break;case G.CHILD_NODE_ADDED:n=this.changeStateChildNodeAdded();break;case G.CHILD_NODE_REMOVED:n=this.changeStateChildNodeRemoved();break;case G.CHILD_NODE_MODIFIED:n=this.changeStateChildNodeModified();break;case G.PARENT_RESIZED:n=this.changeStateParentResized();break;case G.ATTRIBUTE_MODIFIED:n=this.changeStateAttributeModified();break;case G.ELEMENT_LOADED:n=this.changeStateElementLoaded()}return t==G.ALL&&(n=this.changeStateAll()),null!=n&&this.webUIListener.onViewRedraw(n),n},t.prototype.setState=function(t){this.state=t},t.prototype.getState=function(){return this.state},t.setViewLowerState=function(t,e){if(!V.setLowerState(t,e))return null;var n=t.parent;return null!=n?this.setParentOrViewLowerState(n,e):t},t.setParentOrViewLowerState=function(e,n){if(!V.setLowerState(e,n))return null;var i=e.parent;return null!=i?t.setViewLowerState(i,n):e},t.prototype.changeStateAll=function(){var e=t.setParentOrViewLowerState(this.view,d.NONE);return V.setLowerStateToChildren(e||this.view,d.NONE),e},t.prototype.changeStateSize=function(e){return null==this.view.parent?t.setViewLowerState(this.view,d.DOM):t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStateSizePos=function(e){return t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStateStart=function(e){return t.setParentOrViewLowerState(this.view,d.PREPARE)},t.prototype.changeStateEnd=function(e){return t.setParentOrViewLowerState(this.view,d.PREPARE)},t.prototype.changeStateCenter=function(e){return t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStateMarginStart=function(e){return t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStateMarginEnd=function(e){return t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStatePadding=function(e){return t.setParentOrViewLowerState(this.view,d.ORGANIZE)},t.prototype.changeStateOverflow=function(e){return t.setParentOrViewLowerState(this.view,d.PREPARE)},t.prototype.changeStateVisibility=function(){return t.setViewLowerState(this.view,d.CALCULATE)},t.prototype.changeStateVisibilityGone=function(){return t.setParentOrViewLowerState(this.view,d.DOM)},t.prototype.changeStateChildNodeAdded=function(){return t.setParentOrViewLowerState(this.view,d.NONE)},t.prototype.changeStateChildNodeRemoved=function(){return t.setParentOrViewLowerState(this.view,d.NONE)},t.prototype.changeStateChildNodeModified=function(){return t.setParentOrViewLowerState(this.view,d.DOM)},t.prototype.changeStateParentResized=function(){for(var e=!1,n=0,i=r;n<i.length;n++){var a=i[n];e=e||this.view.attrs[a].size==s.PERCENTAGE}return e?t.setViewLowerState(this.view,d.CALCULATE):null},t.prototype.changeStateAttributeModified=function(){return t.setParentOrViewLowerState(this.view,d.NONE)},t.prototype.changeStateElementLoaded=function(){return t.setParentOrViewLowerState(this.view,d.DOM)},t}(),P=function(){function t(){}return t.getOpacity=function(t){return t.style.opacity||window.getComputedStyle(t).getPropertyValue("opacity")},t}();var G;!function(t){t[t.NONE=0]="NONE",t[t.ALL=1]="ALL",t[t.SIZE=2]="SIZE",t[t.SIZE_POS=3]="SIZE_POS",t[t.START=4]="START",t[t.END=5]="END",t[t.CENTER=6]="CENTER",t[t.MARGIN_START=7]="MARGIN_START",t[t.MARGIN_END=8]="MARGIN_END",t[t.PADDING_START=9]="PADDING_START",t[t.PADDING_END=10]="PADDING_END",t[t.OVERFLOW=11]="OVERFLOW",t[t.VISIBILITY=12]="VISIBILITY",t[t.VISIBILITY_GONE=13]="VISIBILITY_GONE",t[t.CHILD_NODE_ADDED=14]="CHILD_NODE_ADDED",t[t.CHILD_NODE_REMOVED=15]="CHILD_NODE_REMOVED",t[t.CHILD_NODE_MODIFIED=16]="CHILD_NODE_MODIFIED",t[t.PARENT_RESIZED=17]="PARENT_RESIZED",t[t.ATTRIBUTE_MODIFIED=18]="ATTRIBUTE_MODIFIED",t[t.ELEMENT_LOADED=19]="ELEMENT_LOADED"}(G||(G={}));var z=function(){this.opacity=""};const U=function(){function t(n,i,r,a,s){var o,h,l,d=this;this.userStyles=new z,this.childrenOrder=((o={})[e.X]=[],o[e.Y]=[],o),this.orderNum=0,this.dependencies=((h={})[e.X]=[],h[e.Y]=[],h),this.dependenciesMap={},this.attrs=new C,this.positions=((l={})[e.X]=new O,l[e.Y]=new O,l),this.animations=[],0==n.id.length&&(n.id="_aID_"+t.generatedId,t.generatedId+=1),this.id=n.id,this.element=y.convert(n,this),this.parent=a,this.screen=s,this.eventsManager=new x(this,i),this.stateManager=new M(this,r),this.userStyles.opacity=P.getOpacity(n),n.style.opacity="0",null!=n.tagName&&"img"==n.tagName.toLowerCase()&&(n.onload=function(){d.eventsManager.onLoadElement()})}return t.prototype.setState=function(t){this.stateManager.setState(t)},t.prototype.changeState=function(t,e){return this.stateManager.changeState(t,e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.forceRefresh=function(){this.stateManager.changeState(G.ALL)},t.prototype.setAttrs=function(t,e,n){for(var i=0;i<t.length;i+=1){var r=t[i];0==i?this.setAttr(r[0],r[1],e,n):this.setAttr(r[0],r[1])}},t.prototype.setAttr=function(t,e,n,i){var r=this.attrs.clone();this.applyAttribute(t,e),this.animateNextRefresh(n,i),this.eventsManager.onChangeAttribute(t,r,e)},t.prototype.applyAttribute=function(t,e){m.readUIAttribute(this.attrs,{attr:t,value:e},this.id)},t.prototype.cleanAttrs=function(t){this.attrs.clean(t)},t.prototype.getAttrs=function(t){return this.attrs[t]},t.prototype.isGone=function(){return this.attrs.visibility==v.GONE},t.prototype.animateNextRefresh=function(t,e){if(null!=t){var n=new S;n.duration=t,n.onEnd=e||null,this.animations.push(n)}},t.prototype.hasUIChildren=function(){return this.getUIChildren().length>0},t.prototype.getChildElements=function(){return y.getAll(this.element.childNodes)},t.prototype.getUIChildren=function(){for(var t=[],e=0,n=y.getAll(this.element.childNodes);e<n.length;e++){var i=n[e],r=y.get(i);null!=r&&t.push(r.ui)}return t},t.prototype.getPreviousView=function(){var t=null;if(null==this.parent)return null;for(var e=this.parent.element.childNodes,n=0;n<e.length;n++){var i=y.get(e[n]);if(null!=i){if(i.id==this.id)return t;i.ui.isGone()||(t=i.ui)}}return null},t.prototype.clean=function(t){this.positions[t].clean()},t.prototype.cleanUI=function(){this.attrs[e.X].clean(),this.attrs[e.Y].clean()},t.prototype.toString=function(){return"["+this.id+"]: ll:"+this.attrs[e.X].startStart+", lr:"+this.attrs[e.X].startEnd+", rr:"+this.attrs[e.X].endEnd+", rl:"+this.attrs[e.X].endStart+", tt:"+this.attrs[e.Y].startStart+",tb: "+this.attrs[e.Y].startEnd+", bb:"+this.attrs[e.Y].endEnd+", bt:"+this.attrs[e.Y].endStart+", ml:"+this.positions[e.X].marginStart+", mr:"+this.positions[e.X].marginEnd+", mt:"+this.positions[e.Y].marginStart+",mb: "+this.positions[e.Y].marginEnd+", pl:"+this.positions[e.X].paddingStart+", pr:"+this.positions[e.X].paddingEnd+", pt:"+this.positions[e.Y].paddingStart+", pb:"+this.positions[e.Y].paddingEnd+", w:"+this.positions[e.X].size+", h:"+this.positions[e.Y].size+", sh:"+this.attrs[e.X].size+", sh:"+this.attrs[e.Y].size+", pId:"+(this.parent?this.parent.id:"")+", l:"+this.positions[e.X].start+", r:"+this.positions[e.X].end+", t:"+this.positions[e.Y].start+", b:"+this.positions[e.Y].end},t.UI_TAG="ui",t.generatedId=0,t}(),H=function(){function t(){}return t.discoverScreens=function(e,n,i,r,a){void 0===a&&(a=!1);var s=!1;if(e.hasAttribute(n.attribute)){if(!a&&null==y.get(e)){var o=new U(e,n,i);r(o)}s=!0}e.childNodes.forEach((function(e){e instanceof HTMLElement&&t.discoverScreens(e,n,i,r,s)}))},t.prepareDom=function(e,n,i,r,a){var s=y.get(e);if(null==s){if(e.hasAttribute(n.attribute)){var o=new U(e,n,i,r,a);o.attrs=m.readAttrs(o.element,n),e.childNodes.forEach((function(e){e instanceof HTMLElement&&t.prepareDom(e,n,i,o,a)})),o.setState(d.DOM)}}else{var h=s.ui;h.getState()<d.DOM&&(h.attrs=m.readAttrs(h.element,n),e.childNodes.forEach((function(e){e instanceof HTMLElement&&t.prepareDom(e,n,i,h,a)})),h.setState(d.DOM))}},t.clearUIDom=function(e){delete e.ui,e.childNodes.forEach((function(e){t.clearUIDom(e)}))},t}(),Y=function(){function i(){}return i.organize=function(t){if(!(t.getState()>=d.ORGANIZE)){for(var n=0,i=t.getUIChildren();n<i.length;n++)(s=i[n]).dependencies[e.X]=[],s.dependencies[e.Y]=[];t.childrenOrder[e.X]=this.orderViewsSameParent(t,!0),t.childrenOrder[e.Y]=this.orderViewsSameParent(t,!1),this.updateDependenciesMap(t);for(var r=0,a=t.getUIChildren();r<a.length;r++){var s=a[r];this.organize(s)}t.setState(d.ORGANIZE)}},i.orderViewsSameParent=function(i,r){for(var a=[],s=0,o=null,l=0,d=i.getUIChildren();l<d.length;l++){for(var c=d[l],u=0,E=r?c.getAttrs(e.X):c.getAttrs(e.Y),f=0,p=h;f<p.length;f++){var T=p[f],v=E.getRef(T);v==n.PARENT?v=i.id:v==n.LAST&&(v=o?o.id:n.NONE),v.length>0&&(r?c.dependencies[e.X].push(v):c.dependencies[e.Y].push(v),u++)}0==u?(c.orderNum=0,s++):c.orderNum=-1,a.push(c),o=c}var S=i.getChildElements(),A=t.generateIndexes(y.convertToUIView(S)),N=!0,I=0;do{N=!0,I=0;for(var w=0,R=i.getUIChildren();w<R.length;w++)if(-1==(c=R[w]).orderNum){for(var D=r?c.dependencies[e.X]:c.dependencies[e.Y],O=0,C=0;C<D.length;C++){var _=0;if(null!=A[D[C]]&&(_=S[A[D[C]]].ui.orderNum),!(_>-1)){O=0;break}O+=_+1}O>0?(c.orderNum=O,I++):N=!1}}while(!N&&I>0);return 0==I&&i.hasUIChildren()&&s<S.length&&g.logE("Check cycle references in "+(r?"horizontal":"vertical")+" for parent "+i.id),a.sort((function(t,e){return t.orderNum-e.orderNum})),a},i.updateDependenciesMap=function(t){t.dependenciesMap={},t.dependenciesMap[t.id]=t;for(var e=0,n=t.getUIChildren();e<n.length;e++){var i=n[e];t.dependenciesMap[i.id]=i}},i}(),k=function(){function t(t){this.webUIListener=t}return t.prototype.init=function(t,e){var n=this;this.configuration=e,new MutationObserver((function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];"childList"==r.type?n.evalModifiedDom(r):"characterData"==r.type?n.evalModifiedData(r):"attributes"==r.type&&n.evalModifiedAttribute(r)}})).observe(t,{childList:!0,characterData:!0,attributes:!0,subtree:!0})},t.prototype.evalModifiedDom=function(t){var e=this;g.log("evalModifiedDom");var n=t.target;if(n instanceof HTMLElement){var i=[];t.addedNodes.forEach((function(t){e.evalAddedNode(t,n),i.push(t)})),t.removedNodes.forEach((function(t){i.includes(t)||e.evalRemovedNode(n)}))}},t.prototype.evalAddedNode=function(t,e){var n;if(g.log("evalAddedNode"),t instanceof HTMLElement){var i=p.getPreviousElementWithAttribute(this.configuration.attribute,e);null!=i&&(g.log("Event 'addedNode' being processed for view "+i.id),null===(n=y.get(i))||void 0===n||n.ui.changeState(G.CHILD_NODE_ADDED)),this.webUIListener.onElementDiscover(e)}else this.evalModifiedNode(e)},t.prototype.evalRemovedNode=function(t){var e;g.log("evalRemovedNode");var n=y.get(t);if(null!=n)return g.log("Event 'removedNode' with UI being processed for view "+n.id),void n.ui.changeState(G.CHILD_NODE_REMOVED);var i=p.getPreviousElementWithAttribute(this.configuration.attribute,t);null!=i&&(g.log("Event 'removedNode' being processed for view "+i.id),null===(e=y.get(i))||void 0===e||e.ui.changeState(G.CHILD_NODE_REMOVED))},t.prototype.evalModifiedNode=function(t){g.log("evalModifiedNode");var e=p.getPreviousElementWithAttribute(this.configuration.attribute,t);if(null!=e){var n=y.get(e);null!=n?(g.log("Event 'modifiedNode' being processed for view "+n.id),n.ui.changeState(G.CHILD_NODE_ADDED)):g.logE("UNEXPECTED: element has the UI attribute but it is not initialized")}},t.prototype.evalModifiedData=function(t){var e=t.target.parentElement;if(e instanceof HTMLElement&&null!=p.getPreviousElementWithAttribute(this.configuration.attribute,e)){var n=y.get(e);null!=n&&(g.log("Event 'modifiedaData' being processed for view "+n.id),n.ui.changeState(G.ATTRIBUTE_MODIFIED))}},t.prototype.evalModifiedAttribute=function(t){var e=t.target;if(e instanceof HTMLElement){var n=t.attributeName||"",i=y.get(e);if(("style"!==n||null==i)&&("id"===n||"class"===n||n===this.configuration.attribute||this.configuration.attributes.includes(n))){if(null==i){var r=p.getPreviousElementWithAttribute(this.configuration.attribute,e);if(null==r)return;var a=y.get(r);if(null==a)return;return g.log("Event 'modifiedAttributeInside' being processed for view "+a.id),void a.ui.changeState(G.CHILD_NODE_MODIFIED)}i.ui.getState()<=d.NONE||(g.log("Event 'modifiedAttribute' '"+n+"' being processed for view "+i.id+" - "+i.ui.getState()),i.ui.eventsManager.evalAttributeModified(n))}}},t}(),B=function(){function t(){}return t.evalViewDependencies=function(t,e,n,i){var r=e.positions[t].clone();r.clean();for(var a=0,s=e.getAttrs(t),o=0,l=h;o<l.length;o++){var d=l[o],c=this.translateViewDependency(e,s.getRef(d),n);if(c.length>0){var u=n.dependenciesMap[c];null!=u?(this.evalViewDependence(t,r,n,i,d,u),a+=1):g.logE("The view "+e.id+" has a wrong reference: "+d)}}return 0!=a||e.attrs[t].center||this.evalDependenceStartStart(r,i,!0,n.positions[t]),r},t.evalViewDependence=function(t,e,n,r,a,s){var o=s.positions[t],h=s==n;switch(a){case i.START_START:this.evalDependenceStartStart(e,r,h,o);break;case i.START_END:this.evalDependenceStartEnd(e,r,h,o);break;case i.END_END:this.evalDependenceEndEnd(e,r,h,o);break;case i.END_START:this.evalDependenceEndStart(e,r,h,o);break;case i.CENTER:this.evalDependenceCenter(e,r,h,o)}},t.evalDependenceStartStart=function(t,e,n,i){t.start=n?e.start:i.start,t.start+=t.marginStart,t.startChanged=!0},t.evalDependenceStartEnd=function(t,e,n,i){t.start=n?e.end:i.end,t.start+=t.marginStart,t.startChanged=!0},t.evalDependenceEndEnd=function(t,e,n,i){t.end=n?e.end:i.end,t.end-=t.marginEnd,t.endChanged=!0},t.evalDependenceEndStart=function(t,e,n,i){t.end=n?e.start:i.start,t.end-=t.marginEnd,t.endChanged=!0},t.evalDependenceCenter=function(t,e,n,i){n?(t.center=(e.start+e.end)/2,t.centerChanged=!0):(t.center=(i.start+t.end)/2,t.centerChanged=!0)},t.translateViewDependency=function(t,e,i){if(e==n.PARENT)return i.id;if(e==n.LAST){var r=t.getPreviousView();return null!=r?r.id:""}return e},t}(),F=function(){function t(){}return t.calculate=function(t,e,n,i){var r=e.attrs[t],s=e.positions[t],o=new a;return o.end=this.calculateSize(t,e,n),this.applyPaddingToContentRect(o,r,s),this.applyScrollToContentRect(o,r,s,i),o},t.calculateSize=function(t,e,n){var i=e.attrs[t];return i.size==s.SIZE_CONTENT?this.calculateSizeContent(t,e,n):i.size==s.PERCENTAGE?n*i.sizeValue/100:i.sizeValue},t.calculateSizeContent=function(t,e,n){var i=e.parent;if(null!=i){var r=new a;r.end=n;var s=B.evalViewDependencies(t,e,i,r);return s.startChanged&&s.endChanged?Math.max(0,s.end-s.start):0}return 0},t.applyPaddingToContentRect=function(t,e,n){e.size==s.SIZE_CONTENT&&0==t.end?t.end+=n.paddingStart:t.end-=n.paddingEnd,t.start+=n.paddingStart},t.applyScrollToContentRect=function(t,e,n,i){n.scrollApplied&&e.overflow==o.SCROLL&&(t.end-t.start<=n.size||(e.size==s.SIZE_CONTENT?t.end+=i:t.end-=i))},t}(),X=function(){function n(){}return n.calculate=function(t,e,n,i){var r=F.calculate(t,e,n,i);this.calculateChildren(t,e,r,i),e.positions[t].endChanged||(e.positions[t].end=this.getMaxEndOfChildren(t,e),e.positions[t].endChanged=!0)},n.calculateChildren=function(t,e,n,i,a){if(void 0===a&&(a=!1),e.hasUIChildren()){for(var o=e.attrs[t],h=0,l=e.childrenOrder[t];h<l.length;h++){var c=l[h];c.hasUIChildren()&&this.calculate(t,c,n.size(),i),c.positions[t]=B.evalViewDependencies(t,c,e,n),this.evalViewSize(t,c,n),this.evalViewPositions(t,c),t==r[r.length-1]&&c.setState(d.CALCULATE)}o.size!=s.SIZE_CONTENT||0!=n.size()||a||(n.end=this.getMaxEndOfChildren(t,e,!0),this.calculateChildren(t,e,n,i,!0))}},n.evalViewSize=function(t,e,n){var i=e.attrs[t],r=e.positions[t],a=n.end-n.start;if(r.startChanged&&r.endChanged)r.size=r.end-r.start;else if(i.size==s.SIZE_CONTENT)this.evalViewSizeContent(t,e,n);else if(i.size==s.PERCENTAGE){var o=a-r.marginStart-r.marginEnd;r.size=o*i.sizeValue/100,i.percentPos>0&&(r.start=n.start+r.size*i.percentPos+r.marginStart,r.startChanged=!0)}else r.size=i.sizeValue},n.evalViewSizeContent=function(n,i,r){var a=i.positions[n],s=i.attrs[n];if(i.hasUIChildren()){var o=this.getMaxEndOfChildren(n,i);a.size=o}else n==e.Y?a.size=t.calculateHeightView(i.element,i.positions[e.X].size):a.size=s.sizeValue;a.size+=a.paddingEnd},n.getMaxEndOfChildren=function(t,e,n){void 0===n&&(n=!1);for(var i=0,r=0,a=e.getUIChildren();r<a.length;r++){var s=a[r].positions[t];i=n&&s.start<0?Math.max(i,s.end-s.start):Math.max(i,s.end)}return i},n.evalViewPositions=function(t,e){var n=e.positions[t];if(n.centerChanged)return n.start=n.center-n.size/2,n.end=n.center+n.size/2,n.startChanged=!0,void(n.endChanged=!0);n.startChanged||(n.endChanged&&(n.start=n.end-n.size),n.startChanged=!0),n.endChanged||(n.startChanged&&(n.end=n.start+n.size),n.endChanged=!0)},n}(),W=function(){function t(){}return t.calculate=function(t,e,n){if(!(t.getState()>=d.CALCULATE)){this.translateMarginsAndPaddings(t,e);for(var i=0,a=r;i<a.length;i++){var s=a[i];this.calculateView(s,t,n,t.positions[s].size)}}},t.calculateView=function(t,e,n,i){X.calculate(t,e,i,n),t==r[r.length-1]&&e.setState(d.CALCULATE)},t.translateMarginsAndPaddings=function(t,e){if(!(t.getState()>=d.CALCULATE)){for(var n=0,i=r;n<i.length;n++){var a=i[n];this.translateMargins(t.attrs[a],e,t.positions[a]),this.translatePaddings(t.attrs[a],e,t.positions[a])}for(var s=0,o=t.getUIChildren();s<o.length;s++){var h=o[s];this.translateMarginsAndPaddings(h,e)}}},t.translateMargins=function(t,e,n){n.marginStart=e.getDimen(t.marginStart),n.marginEnd=e.getDimen(t.marginEnd)},t.translatePaddings=function(t,e,n){n.paddingStart=e.getDimen(t.paddingStart),n.paddingEnd=e.getDimen(t.paddingEnd)},t}(),Z=new(function(){function t(){this.scrollSize=0,this.configuration=new f,this.eventsManager=new k(this),this.elementsToDiscover=[],this.viewsToDraw={}}return t.prototype.start=function(t){this.configuration=new f(t),this.redrawTimer=new u(this.redraw.bind(this),this.configuration.timeRedraw),g.uiShowLogs=this.configuration.showLogs,g.uiViewLogs=this.configuration.logsView;var e=document.getElementsByTagName("BODY")[0];0==this.scrollSize&&(this.scrollSize=p.getScrollWidth()),this.configuration.sendStartEvent(),this.discoverAndDraw(e),this.eventsManager.init(e,this.configuration),this.configuration.sendEndEvent()},t.prototype.discoverAndDraw=function(t){var e=this;g.log("[WebUI] Start processing"),T.startCounter("drawScreens"),H.discoverScreens(t,this.configuration,this,(function(t){e.drawUIView(t)})),g.log("[WebUI] End processing("+T.endCounter("drawScreens")+")")},t.prototype.drawUIView=function(t){var e,n,i,r,a,s;g.log("["+t.id+"] Start processing screen"),T.startCounter("all"),T.startCounter("dom"),H.prepareDom(t.element,this.configuration,this,t,t),e=T.endCounter("dom"),T.startCounter("prepare"),c.prepareScreen(t,this.configuration),n=T.endCounter("prepare"),T.startCounter("organize"),Y.organize(t),i=T.endCounter("organize"),T.startCounter("calculate"),W.calculate(t,this.configuration,this.scrollSize),r=T.endCounter("calculate"),T.startCounter("draw"),w.generateDraws(t,this.configuration),w.applyDraws(t,this.configuration),a=T.endCounter("draw"),s=T.endCounter("all"),g.log("["+t.id+"] End processing: All("+s+") Dom("+e+") Prepare("+n+") Organize("+i+") Calculate("+r+") Draw("+a+")")},t.prototype.onElementDiscover=function(t){this.elementsToDiscover.includes(t)||(this.elementsToDiscover.push(t),this.redrawTimer.execute())},t.prototype.onViewRedraw=function(t){this.viewsToDraw[t.id]=t,this.redrawTimer.execute()},t.prototype.redraw=function(){var t=this.elementsToDiscover.slice(0);this.elementsToDiscover=[];for(var e=[],n=0,i=Object.keys(this.viewsToDraw);n<i.length;n++){var r=i[n];e.push(this.viewsToDraw[r])}this.viewsToDraw={},g.log("[WebUI] Start redrawing"),T.startCounter("redraw");for(var a=0,s=t;a<s.length;a++){var o=s[a];this.discoverAndDraw(o)}for(var h=0,l=e;h<l.length;h++){var d=l[h];this.drawUIView(d)}g.log("[WebUI] End redraw("+T.endCounter("redraw")+")")},t}());window.WebUI=Z,window.WebUI.start=Z.start,exports.WebUI=Z})();